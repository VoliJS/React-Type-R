{"version":3,"file":"index.js","sources":["../node_modules/tslib/tslib.es6.js","../lib/define/common.js","../lib/define/state.js","../lib/define/typeSpecs.js","../lib/define/pureRender.js","../lib/define/props.js","../lib/define/index.js","../lib/component.js","../node_modules/valuelink/lib/helpers.js","../node_modules/valuelink/lib/link.js","../lib/link.js","../lib/builtins.js","../lib/index.js"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { createContext } from 'react';\nimport { Store } from 'type-r';\n// Context for the Type-R store\nexport var StoreContext = createContext(Store.global);\nexport var ExposeStore = StoreContext.Provider;\nexport var AccessStore = StoreContext.Consumer;\n//# sourceMappingURL=common.js.map","import * as tslib_1 from \"tslib\";\n/*****************\n * State\n */\nimport { define, Record } from 'type-r';\nimport { StoreContext } from './common';\nexport default function process(definition, BaseComponentClass) {\n    var prototype = this.prototype;\n    var state = definition.state, State = definition.State;\n    if (typeof state === 'function') {\n        State = state;\n        state = void 0;\n    }\n    if (state) {\n        var BaseClass = State || prototype.State || Record;\n        var ComponentState = /** @class */ (function (_super) {\n            tslib_1.__extends(ComponentState, _super);\n            function ComponentState() {\n                return _super !== null && _super.apply(this, arguments) || this;\n            }\n            ComponentState.attributes = state;\n            ComponentState = tslib_1.__decorate([\n                define\n            ], ComponentState);\n            return ComponentState;\n        }(BaseClass));\n        prototype.State = ComponentState;\n    }\n    else if (State) {\n        prototype.State = State;\n    }\n    if (state || State) {\n        this.mixins.merge([StateMixin]);\n    }\n}\nvar StateMixin = /** @class */ (function () {\n    function StateMixin() {\n    }\n    StateMixin.prototype._initializeState = function () {\n        // props.__keepState is used to workaround issues in Backbone intergation layer\n        var state = this.state = this.props.__keepState || new this.State();\n        // Take ownership on state...\n        state._owner = this;\n        state._ownerKey = 'state';\n    };\n    StateMixin.prototype._onChildrenChange = function () { };\n    StateMixin.prototype.componentDidMount = function () {\n        this._onChildrenChange = this.asyncUpdate;\n    };\n    StateMixin.prototype.componentWillUnmount = function () {\n        var state = this.state;\n        state._owner = state._ownerKey = void 0;\n        this._preventDispose /* hack for component-view to preserve the state */ || state.dispose();\n        this.state = void 0;\n    };\n    StateMixin.contextType = StoreContext;\n    return StateMixin;\n}());\nexport { StateMixin };\n;\n//# sourceMappingURL=state.js.map","import * as PropTypes from 'prop-types';\nimport { Record } from 'type-r';\nexport function compileSpecs(props) {\n    var propTypes = {}, \n    // Create NestedTypes model definition to process props spec.\n    modelProto = Record.defaults(props).prototype;\n    var defaults, watchers, changeHandlers;\n    var _loop_1 = function (spec) {\n        var name_1 = spec.name;\n        // Skip auto-generated `id` attribute.\n        if (name_1 !== 'id') {\n            var value = spec.value, type = spec.type, options = spec.options;\n            // Translate props type to the propTypes guard.\n            propTypes[name_1] = translateType(type, options.isRequired);\n            if (options._onChange) {\n                watchers || (watchers = {});\n                watchers[name_1] = toLocalWatcher(options._onChange);\n            }\n            // Handle listening to event maps...\n            if (options.changeHandlers && options.changeHandlers.length) {\n                changeHandlers || (changeHandlers = {});\n                changeHandlers[name_1] = options.changeHandlers;\n            }\n            // Handle listening to props changes...\n            if (options.changeEvents) {\n                changeHandlers || (changeHandlers = {});\n                var handlers = changeHandlers[name_1] || (changeHandlers[name_1] = []), changeEvents_1 = typeof options.changeEvents === 'string' ? options.changeEvents : null;\n                handlers.push(function (next, prev, component) {\n                    prev && component.stopListening(prev);\n                    next && component.listenTo(next, changeEvents_1 || next._changeEventName, component.asyncUpdate);\n                });\n            }\n            // If default value is explicitly provided...\n            if (value !== void 0) {\n                //...append it to getDefaultProps function.\n                defaults || (defaults = {});\n                defaults[name_1] = spec.convert(value, void 0, null, {});\n            }\n        }\n    };\n    for (var _i = 0, _a = modelProto._attributesArray; _i < _a.length; _i++) {\n        var spec = _a[_i];\n        _loop_1(spec);\n    }\n    return { propTypes: propTypes, defaults: defaults, watchers: watchers, changeHandlers: changeHandlers };\n}\nfunction toLocalWatcher(ref) {\n    return typeof ref === 'function' ? ref : function (value, name) {\n        this[ref] && this[ref](value, name);\n    };\n}\nvar Node = /** @class */ (function () {\n    function Node() {\n    }\n    return Node;\n}());\nexport { Node };\nvar Element = /** @class */ (function () {\n    function Element() {\n    }\n    return Element;\n}());\nexport { Element };\nfunction translateType(Type, isRequired) {\n    var T = _translateType(Type);\n    return isRequired ? T.isRequired : T;\n}\nfunction _translateType(Type) {\n    switch (Type) {\n        case Number:\n            return PropTypes.number;\n        case String:\n            return PropTypes.string;\n        case Boolean:\n            return PropTypes.bool;\n        case Array:\n            return PropTypes.array;\n        case Function:\n            return PropTypes.func;\n        case Object:\n            return PropTypes.object;\n        case Node:\n            return PropTypes.node;\n        case Element:\n            return PropTypes.element;\n        case void 0:\n        case null:\n            return PropTypes.any;\n        default:\n            return PropTypes.instanceOf(Type);\n    }\n}\n//# sourceMappingURL=typeSpecs.js.map","export function createChangeTokensConstructor(props) {\n    var propNames = Object.keys(props);\n    var PropsChangeTokens = new Function('p', 's', \"\\n        var v;\\n        this._s = s && s._changeToken;\\n        \" + propNames.map(function (name) { return \"\\n            this.\" + name + \" = ( ( v = p.\" + name + \") && v._changeToken ) || v;\\n        \"; }).join('') + \"\\n    \");\n    PropsChangeTokens.prototype._hasChanges = new Function('p', 's', \"\\n        var v;\\n        return ( ( s && s._changeToken ) !== this._s ) \" + propNames.map(function (name) { return \" ||\\n            this.\" + name + \" !== ( ( ( v = p.\" + name + \") && v._changeToken ) || v )\\n        \"; }).join('') + \";\\n    \");\n    return PropsChangeTokens;\n}\n;\nexport var EmptyPropsChangeTokensCtor = createChangeTokensConstructor({});\nexport var PureRenderMixin = {\n    shouldComponentUpdate: function (nextProps) {\n        return this._propsChangeTokens._hasChanges(nextProps, this.state);\n    },\n    componentDidMount: updateChangeTokens,\n    componentDidUpdate: updateChangeTokens\n};\nfunction updateChangeTokens() {\n    this._propsChangeTokens = new this.PropsChangeTokens(this.props, this.state);\n}\n//# sourceMappingURL=pureRender.js.map","/**\n * Handle props specification and everything which is related:\n * - local listening to props changes\n * - pure render mixin\n */\nimport { compileSpecs } from './typeSpecs';\nimport { PureRenderMixin, createChangeTokensConstructor } from './pureRender';\nimport { tools } from 'type-r';\nexport default function onDefine(_a, BaseClass) {\n    var props = _a.props, pureRender = _a.pureRender;\n    var prototype = this.prototype;\n    // process props spec...\n    if (props) {\n        // Merge with inherited members...\n        prototype._props = tools.defaults(props, BaseClass.prototype._props || {});\n        var _b = compileSpecs(props), propTypes = _b.propTypes, defaults = _b.defaults, watchers = _b.watchers, changeHandlers = _b.changeHandlers;\n        this.propTypes = propTypes;\n        if (defaults)\n            this.defaultProps = defaults;\n        if (watchers) {\n            prototype._watchers = watchers;\n            this.mixins.merge([WatchersMixin]);\n        }\n        if (changeHandlers) {\n            prototype._changeHandlers = changeHandlers;\n            this.mixins.merge([ChangeHandlersMixin]);\n        }\n        if (prototype.pureRender) {\n            prototype.PropsChangeTokens = createChangeTokensConstructor(props);\n        }\n    }\n    if (pureRender) {\n        this.mixins.merge([PureRenderMixin]);\n    }\n}\n/**\n * ChangeHandlers are fired in sequence upon props replacement.\n * Fires _after_ UI is updated. Used for managing events subscriptions.\n */\nvar ChangeHandlersMixin = {\n    componentDidMount: function () {\n        handlePropsChanges(this, {}, this.props);\n    },\n    componentDidUpdate: function (prev) {\n        handlePropsChanges(this, prev, this.props);\n    },\n    componentWillUnmount: function () {\n        handlePropsChanges(this, this.props, {});\n    }\n};\nfunction handlePropsChanges(component, prev, next) {\n    var _changeHandlers = component._changeHandlers;\n    for (var name_1 in _changeHandlers) {\n        if (prev[name_1] !== next[name_1]) {\n            for (var _i = 0, _a = _changeHandlers[name_1]; _i < _a.length; _i++) {\n                var handler = _a[_i];\n                handler(next[name_1], prev[name_1], component);\n            }\n        }\n    }\n}\n/**\n * Watchers works on props replacement and fires _before_ any change will be applied and UI is updated.\n * Fired in componentWillMount as well, which makes it a nice way to sync state from props.\n */\nvar WatchersMixin = {\n    componentWillReceiveProps: function (next) {\n        var _a = this, _watchers = _a._watchers, props = _a.props;\n        for (var name_2 in _watchers) {\n            if (next[name_2] !== props[name_2]) {\n                _watchers[name_2].call(this, next[name_2], name_2);\n            }\n        }\n    },\n    componentWillMount: function () {\n        var _a = this, _watchers = _a._watchers, props = _a.props;\n        for (var name_3 in _watchers) {\n            _watchers[name_3].call(this, props[name_3], name_3);\n        }\n    }\n};\n//# sourceMappingURL=props.js.map","import { Messenger } from 'type-r';\nimport onDefineState from './state';\nimport onDefineProps from './props';\nexport default function onDefine(definition, BaseClass) {\n    // Initialize mixins placeholder...\n    onDefineState.call(this, definition, BaseClass);\n    onDefineProps.call(this, definition, BaseClass);\n    Messenger.onDefine.call(this, definition, BaseClass);\n}\n;\nexport { Node, Element } from './typeSpecs';\nexport { EmptyPropsChangeTokensCtor } from './pureRender';\n//# sourceMappingURL=index.js.map","import * as tslib_1 from \"tslib\";\n/**\n * React-Type-R component base class. Overrides React component.\n */\nimport * as React from 'react';\nimport { Messenger, Store, define, definitions, mixinRules, mixins } from 'type-r';\nimport onDefine, { EmptyPropsChangeTokensCtor } from './define';\nvar Component = /** @class */ (function (_super) {\n    tslib_1.__extends(Component, _super);\n    function Component(props, context) {\n        var _this = _super.call(this, props, context) || this;\n        _this._initializeState();\n        return _this;\n    }\n    Component.prototype.linkAt = function (key) {\n        // Quick and dirty hack to suppres type error - refactor later.\n        return this.state.linkAt(key);\n    };\n    Component.prototype.linkAll = function () {\n        // Quick and dirty hack to suppres type error - refactor later.\n        var state = this.state;\n        return state.linkAll.apply(state, arguments);\n    };\n    Component.prototype.linkPath = function (path) {\n        return this.state.linkPath(path);\n    };\n    Object.defineProperty(Component.prototype, \"links\", {\n        get: function () {\n            return this.state._links;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Component.prototype._initializeState = function () {\n        this.state = null;\n    };\n    Component.prototype.assignToState = function (x, key) {\n        var _a;\n        this.state.assignFrom((_a = {}, _a[key] = x, _a));\n    };\n    Component.prototype.setState = function (attrs) {\n        this.state.set(typeof attrs === 'function' ? attrs.call(this, this.state, this.props) : attrs);\n    };\n    Component.prototype.componentWillUnmount = function () {\n        this.dispose();\n    };\n    /**\n     * Performs transactional update for both props and state.\n     * Suppress updates during the transaction, and force update aftewards.\n     * Wrapping the sequence of changes in a transactions guarantees that\n     * React component will be updated _after_ all the changes to the\n     * both props and local state are applied.\n     */\n    Component.prototype.transaction = function (fun) {\n        var shouldComponentUpdate = this.shouldComponentUpdate, isRoot = shouldComponentUpdate !== returnFalse;\n        if (isRoot) {\n            this.shouldComponentUpdate = returnFalse;\n        }\n        this.state.transaction(fun);\n        if (isRoot) {\n            this.shouldComponentUpdate = shouldComponentUpdate;\n            this.asyncUpdate();\n        }\n    };\n    // reference global store to fix model's store locator\n    Component.prototype.getStore = function () {\n        // Attempt to get the store from the context first. Then - fallback to the state's default store.\n        // TBD: Need to figure out a good way of managing local stores.\n        var context, state;\n        return ((context = this.context) && context) ||\n            ((state = this.state) && state._defaultStore) || Store.global;\n    };\n    // Safe version of the forceUpdate suitable for asynchronous callbacks.\n    Component.prototype.asyncUpdate = function () {\n        this.shouldComponentUpdate === returnFalse || this._disposed || this.forceUpdate();\n    };\n    Component.onDefine = onDefine;\n    Component = tslib_1.__decorate([\n        define({\n            PropsChangeTokens: EmptyPropsChangeTokensCtor\n        }),\n        definitions({\n            // Definitions to be extracted from mixins and statics and passed to `onDefine()`\n            state: mixinRules.merge,\n            State: mixinRules.value,\n            props: mixinRules.merge,\n            pureRender: mixinRules.protoValue\n        }),\n        mixinRules({\n            // Apply old-school React mixin rules.\n            componentWillMount: mixinRules.classLast,\n            componentDidMount: mixinRules.classLast,\n            componentWillReceiveProps: mixinRules.classLast,\n            componentWillUpdate: mixinRules.classLast,\n            componentDidUpdate: mixinRules.classLast,\n            componentWillUnmount: mixinRules.classFirst,\n            // And a bit more to fix inheritance quirks.\n            shouldComponentUpdate: mixinRules.some,\n        })\n        // Component can send and receive events...\n        ,\n        mixins(Messenger)\n    ], Component);\n    return Component;\n}(React.Component));\nexport { Component };\nfunction returnFalse() { return false; }\n// Looks like React guys _really_ want to deprecate it. But no way.\n// We will work around their attempt.\nObject.defineProperty(Component.prototype, 'isMounted', {\n    value: function isMounted() {\n        return !this._disposed;\n    }\n});\n//# sourceMappingURL=component.js.map","var ArrayProto = Array.prototype, ObjectProto = Object.prototype;\nexport function helpers(value) {\n    if (value && typeof value === 'object') {\n        switch (Object.getPrototypeOf(value)) {\n            case ArrayProto: return arrayHelpers;\n            case ObjectProto: return objectHelpers;\n        }\n    }\n    return dummyHelpers;\n}\n// Do nothing for types other than Array and plain Object.\nvar dummyHelpers = {\n    clone: function (value) { return value; },\n    map: function (link, fun) { return []; },\n    remove: function (value) { return value; }\n};\n// `map` and `clone` for plain JS objects\nexport var objectHelpers = {\n    // Map through the link to object\n    map: function (link, iterator) {\n        var mapped = [];\n        for (var key in link.value) {\n            var element = iterator(link.at(key), key);\n            element === void 0 || (mapped.push(element));\n        }\n        return mapped;\n    },\n    remove: function (object, key) {\n        delete object[key];\n        return object;\n    },\n    // Shallow clone plain JS object\n    clone: function (object) {\n        var cloned = {};\n        for (var key in object) {\n            cloned[key] = object[key];\n        }\n        return cloned;\n    }\n};\n// `map` and `clone` helpers for arrays.\nexport var arrayHelpers = {\n    // Shallow clone array\n    clone: function (array) {\n        return array.slice();\n    },\n    remove: function (array, i) {\n        array.splice(i, 1);\n        return array;\n    },\n    // Map through the link to array\n    map: function (link, iterator) {\n        var length = link.value.length, mapped = Array(length);\n        for (var i = 0, j = 0; i < length; i++) {\n            var y = iterator(link.at(i), i);\n            y === void 0 || (mapped[j++] = y);\n        }\n        mapped.length === j || (mapped.length = j);\n        return mapped;\n    }\n};\n//# sourceMappingURL=helpers.js.map","import * as tslib_1 from \"tslib\";\n/**\n * Advanced React links for purely functional two-way data binding\n *\n * MIT License, (c) 2016 Vlad Balin, Volicon.\n */\nimport { helpers, arrayHelpers } from './helpers';\n// Main Link class. All links must extend it.\nvar Link = /** @class */ (function () {\n    // create \n    function Link(value) {\n        this.value = value;\n    }\n    // Create custom link to arbitrary value\n    Link.value = function (value, set) {\n        return new CustomLink(value, set);\n    };\n    Object.defineProperty(Link.prototype, \"validationError\", {\n        // DEPRECATED: Old error holder for backward compatibility with Volicon code base\n        get: function () { return this.error; },\n        enumerable: true,\n        configurable: true\n    });\n    Link.prototype.onChange = function (handler) {\n        var _this = this;\n        return new CloneLink(this, function (x) {\n            handler(x);\n            _this.set(x);\n        });\n    };\n    Object.defineProperty(Link.prototype, \"props\", {\n        // <input { ...link.props } />\n        get: function () {\n            var _this = this;\n            return typeof this.value === 'boolean' ? {\n                checked: this.value,\n                onChange: function (e) { return _this.set(Boolean(e.target.checked)); }\n            } : {\n                value: this.value,\n                onChange: function (e) { return _this.set(e.target.value); }\n            };\n        },\n        enumerable: true,\n        configurable: true\n    });\n    // DEPRECATED: Old React method for backward compatibility\n    Link.prototype.requestChange = function (x) {\n        this.set(x);\n    };\n    // Immediately update the link value using given transform function.\n    Link.prototype.update = function (transform, e) {\n        var next = transform(this.clone(), e);\n        next === void 0 || this.set(next);\n    };\n    // Create new link which applies transform function on set.\n    Link.prototype.pipe = function (handler) {\n        var _this = this;\n        return new CloneLink(this, function (x) {\n            var next = handler(x, _this.value);\n            next === void 0 || _this.set(next);\n        });\n    };\n    // Create UI event handler function which will update the link with a given transform function.\n    Link.prototype.action = function (transform) {\n        var _this = this;\n        return function (e) { return _this.update(transform, e); };\n    };\n    Link.prototype.equals = function (truthyValue) {\n        return new EqualsLink(this, truthyValue);\n    };\n    Link.prototype.enabled = function (defaultValue) {\n        return new EnabledLink(this, defaultValue || \"\");\n    };\n    // Array-only links methods\n    Link.prototype.contains = function (element) {\n        return new ContainsLink(this, element);\n    };\n    Link.prototype.push = function () {\n        var array = arrayHelpers.clone(this.value);\n        Array.prototype.push.apply(array, arguments);\n        this.set(array);\n    };\n    Link.prototype.unshift = function () {\n        var array = arrayHelpers.clone(this.value);\n        Array.prototype.unshift.apply(array, arguments);\n        this.set(array);\n    };\n    Link.prototype.splice = function () {\n        var array = arrayHelpers.clone(this.value);\n        Array.prototype.splice.apply(array, arguments);\n        this.set(array);\n    };\n    Link.prototype.map = function (iterator) {\n        return helpers(this.value).map(this, iterator);\n    };\n    Link.prototype.removeAt = function (key) {\n        var value = this.value, _ = helpers(value);\n        this.set(_.remove(_.clone(value), key));\n    };\n    Link.prototype.at = function (key) {\n        return new LinkAt(this, key);\n    };\n    Link.prototype.clone = function () {\n        var value = this.value;\n        return helpers(value).clone(value);\n    };\n    Link.prototype.pick = function () {\n        var links = {};\n        for (var i = 0; i < arguments.length; i++) {\n            var key = arguments[i];\n            links[key] = new LinkAt(this, key);\n        }\n        return links;\n    };\n    /**\n     * Validate link with validness predicate and optional custom error object. Can be chained.\n     */\n    Link.prototype.check = function (whenValid, error) {\n        if (!this.error && !whenValid(this.value)) {\n            this.error = error || whenValid.error || defaultError;\n        }\n        return this;\n    };\n    return Link;\n}());\nexport { Link };\nvar CustomLink = /** @class */ (function (_super) {\n    tslib_1.__extends(CustomLink, _super);\n    function CustomLink(value, set) {\n        var _this = _super.call(this, value) || this;\n        _this.set = set;\n        return _this;\n    }\n    CustomLink.prototype.set = function (x) { };\n    return CustomLink;\n}(Link));\nexport { CustomLink };\nvar CloneLink = /** @class */ (function (_super) {\n    tslib_1.__extends(CloneLink, _super);\n    function CloneLink(parent, set) {\n        var _this = _super.call(this, parent.value) || this;\n        _this.set = set;\n        var error = parent.error;\n        if (error)\n            _this.error = error;\n        return _this;\n    }\n    CloneLink.prototype.set = function (x) { };\n    return CloneLink;\n}(Link));\nexport { CloneLink };\nvar EqualsLink = /** @class */ (function (_super) {\n    tslib_1.__extends(EqualsLink, _super);\n    function EqualsLink(parent, truthyValue) {\n        var _this = _super.call(this, parent.value === truthyValue) || this;\n        _this.parent = parent;\n        _this.truthyValue = truthyValue;\n        return _this;\n    }\n    EqualsLink.prototype.set = function (x) {\n        this.parent.set(x ? this.truthyValue : null);\n    };\n    return EqualsLink;\n}(Link));\nexport { EqualsLink };\nvar EnabledLink = /** @class */ (function (_super) {\n    tslib_1.__extends(EnabledLink, _super);\n    function EnabledLink(parent, defaultValue) {\n        var _this = _super.call(this, parent.value != null) || this;\n        _this.parent = parent;\n        _this.defaultValue = defaultValue;\n        return _this;\n    }\n    EnabledLink.prototype.set = function (x) {\n        this.parent.set(x ? this.defaultValue : null);\n    };\n    return EnabledLink;\n}(Link));\nexport { EnabledLink };\nvar ContainsLink = /** @class */ (function (_super) {\n    tslib_1.__extends(ContainsLink, _super);\n    function ContainsLink(parent, element) {\n        var _this = _super.call(this, parent.value.indexOf(element) >= 0) || this;\n        _this.parent = parent;\n        _this.element = element;\n        return _this;\n    }\n    ContainsLink.prototype.set = function (x) {\n        var _this = this;\n        var next = Boolean(x);\n        if (this.value !== next) {\n            var arr = this.parent.value, nextValue = x ? arr.concat(this.element) : arr.filter(function (el) { return el !== _this.element; });\n            this.parent.set(nextValue);\n        }\n    };\n    return ContainsLink;\n}(Link));\nexport { ContainsLink };\nvar defaultError = 'Invalid value';\n/**\n * Link to array or object element enclosed in parent link.\n * Performs purely functional update of the parent, shallow copying its value on `set`.\n */\nvar LinkAt = /** @class */ (function (_super) {\n    tslib_1.__extends(LinkAt, _super);\n    function LinkAt(parent, key) {\n        var _this = _super.call(this, parent.value[key]) || this;\n        _this.parent = parent;\n        _this.key = key;\n        return _this;\n    }\n    LinkAt.prototype.remove = function () {\n        this.parent.removeAt(this.key);\n    };\n    // Set new element value to parent array or object, performing purely functional update.\n    LinkAt.prototype.set = function (x) {\n        var _this = this;\n        if (this.value !== x) {\n            this.parent.update(function (value) {\n                value[_this.key] = x;\n                return value;\n            });\n        }\n    };\n    ;\n    return LinkAt;\n}(Link));\nexport { LinkAt };\n//# sourceMappingURL=link.js.map","import * as tslib_1 from \"tslib\";\n/**\n * Import ValueLink library\n * Define value links binding mixins to the Record and Collection\n */\nimport { Mixable, MixinsState, Record } from 'type-r';\nimport { Link } from 'valuelink/lib/link';\nexport default Link;\nMixable.mixins.populate(Link);\n/**\n * Record\n */\nvar LinkedRecordMixin = /** @class */ (function () {\n    function LinkedRecordMixin() {\n    }\n    LinkedRecordMixin.prototype.linkAt = function (key) {\n        return cacheLink(getLinksCache(this), this, key);\n    };\n    // Link to the attribute of the record's tree by symbolic path.\n    LinkedRecordMixin.prototype.linkPath = function (path, options) {\n        return new RecordDeepLink(this, path, options);\n    };\n    // Link all (or listed) attributes and return links cache.\n    LinkedRecordMixin.prototype.linkAll = function () {\n        var links = getLinksCache(this);\n        if (arguments.length) {\n            for (var i = 0; i < arguments.length; i++) {\n                cacheLink(links, this, arguments[i]);\n            }\n        }\n        else {\n            var attributes = this.attributes;\n            for (var key in attributes) {\n                attributes[key] === void 0 || cacheLink(links, this, key);\n            }\n        }\n        return links;\n    };\n    return LinkedRecordMixin;\n}());\nMixinsState.get(Record).merge([LinkedRecordMixin]);\n/**\n * Link to Type-R's record attribute.\n * Strict evaluation of value, lazy evaluation of validation error.\n * Links are cached in the records\n */\nvar RecordLink = /** @class */ (function (_super) {\n    tslib_1.__extends(RecordLink, _super);\n    function RecordLink(record, attr, value) {\n        var _this = _super.call(this, value) || this;\n        _this.record = record;\n        _this.attr = attr;\n        return _this;\n    }\n    RecordLink.prototype.set = function (x) {\n        this.record[this.attr] = x;\n    };\n    Object.defineProperty(RecordLink.prototype, \"error\", {\n        get: function () {\n            return this._error === void 0 ?\n                this.record.getValidationError(this.attr) :\n                this._error;\n        },\n        set: function (x) {\n            this._error = x;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    RecordLink.prototype.assignFrom = function (other) {\n        this.value.assignFrom(other);\n    };\n    return RecordLink;\n}(Link));\nvar RecordDeepLink = /** @class */ (function (_super) {\n    tslib_1.__extends(RecordDeepLink, _super);\n    function RecordDeepLink(record, path, options) {\n        var _this = _super.call(this, record.deepGet(path)) || this;\n        _this.record = record;\n        _this.path = path;\n        _this.options = options;\n        return _this;\n    }\n    Object.defineProperty(RecordDeepLink.prototype, \"error\", {\n        get: function () {\n            if (this._error === void 0) {\n                this._error = this.record.deepValidationError(this.path) || null;\n            }\n            return this._error;\n        },\n        set: function (x) {\n            this._error = x;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(RecordDeepLink.prototype, \"_changeToken\", {\n        get: function () {\n            return this.record._changeToken;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    RecordDeepLink.prototype.set = function (x) {\n        this.record.deepSet(this.path, x, this.options);\n    };\n    RecordDeepLink.prototype.assignFrom = function (other) {\n        this.value.assignFrom(other);\n    };\n    return RecordDeepLink;\n}(Link));\nfunction getLinksCache(record) {\n    return record._links || (record._links = new record.AttributesCopy({}));\n}\nfunction cacheLink(links, record, key) {\n    var cached = links[key], value = record[key];\n    return cached && cached.value === value ? cached\n        : links[key] = new RecordLink(record, key, value);\n}\n/***********************************\n * Collection\n */\nMixinsState.get(Record.Collection).merge([{\n        // Boolean link to the record's presence in the collection\n        linkContains: function (record) {\n            return new CollectionLink(this, record);\n        },\n        // Link to collection's property\n        linkAt: function (prop) {\n            var _this = this;\n            return Link.value(this[prop], function (x) { return _this[prop] = x; });\n        }\n    }]);\n/**\n * Boolean link to presence of NestedType's record in collection.\n * Strict evaluation of value, no error.\n * Safe implementation of _changeToken.\n */\nvar CollectionLink = /** @class */ (function (_super) {\n    tslib_1.__extends(CollectionLink, _super);\n    function CollectionLink(collection, record) {\n        var _this = _super.call(this, Boolean(collection.get(record))) || this;\n        _this.collection = collection;\n        _this.record = record;\n        return _this;\n    }\n    CollectionLink.prototype.set = function (x) {\n        this.collection.toggle(this.record, x);\n    };\n    return CollectionLink;\n}(Link));\n//# sourceMappingURL=link.js.map","import * as tslib_1 from \"tslib\";\nimport * as React from 'react';\nimport { Component } from './component';\nimport { define } from 'type-r';\nimport { ExposeStore } from './define/common';\nexport function localStoreComponent(StoreClass, ComponentClass) {\n    var LocalStoreComponent = /** @class */ (function (_super) {\n        tslib_1.__extends(LocalStoreComponent, _super);\n        function LocalStoreComponent() {\n            return _super !== null && _super.apply(this, arguments) || this;\n        }\n        LocalStoreComponent_1 = LocalStoreComponent;\n        LocalStoreComponent.prototype.get = function (key) {\n            // Ask an upper store.\n            var store = this.getStore();\n            return store && store.get(key);\n        };\n        LocalStoreComponent.prototype.render = function () {\n            var _a = this.props, children = _a.children, props = tslib_1.__rest(_a, [\"children\"]);\n            return (React.createElement(ExposeStore, { value: this.state },\n                React.createElement(ComponentClass, tslib_1.__assign({}, props, { store: this.state }), children)));\n        };\n        var LocalStoreComponent_1;\n        LocalStoreComponent.state = StoreClass;\n        LocalStoreComponent = LocalStoreComponent_1 = tslib_1.__decorate([\n            define\n        ], LocalStoreComponent);\n        return LocalStoreComponent;\n    }(Component));\n    return LocalStoreComponent;\n}\n/**\n * Connect external store.\n * @param store\n * @param ComponentClass\n */\nexport function externalStoreComponent(store, ComponentClass) {\n    var ExternalStoreComponent = /** @class */ (function (_super) {\n        tslib_1.__extends(ExternalStoreComponent, _super);\n        function ExternalStoreComponent() {\n            var _this = _super !== null && _super.apply(this, arguments) || this;\n            _this.store = store;\n            return _this;\n        }\n        ExternalStoreComponent_1 = ExternalStoreComponent;\n        ExternalStoreComponent.prototype.render = function () {\n            var _a = this.props, children = _a.children, props = tslib_1.__rest(_a, [\"children\"]);\n            return (React.createElement(ExposeStore, { value: this.store },\n                React.createElement(ComponentClass, tslib_1.__assign({}, props, { store: this.store }), children)));\n        };\n        ExternalStoreComponent.prototype.componentDidMount = function () {\n            this.listenTo(this.store, 'change', this.asyncUpdate);\n        };\n        var ExternalStoreComponent_1;\n        ExternalStoreComponent = ExternalStoreComponent_1 = tslib_1.__decorate([\n            define\n        ], ExternalStoreComponent);\n        return ExternalStoreComponent;\n    }(Component));\n    return ExternalStoreComponent;\n}\nvar PureComponent = /** @class */ (function (_super) {\n    tslib_1.__extends(PureComponent, _super);\n    function PureComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PureComponent.pureRender = true;\n    PureComponent = tslib_1.__decorate([\n        define\n    ], PureComponent);\n    return PureComponent;\n}(Component));\nexport { PureComponent };\n//# sourceMappingURL=builtins.js.map","import * as React from 'react';\nimport { define, mixins, type } from 'type-r';\nimport { Component } from './component';\nimport { Element, Node } from './define';\nimport Link from './link';\nexport * from './builtins';\n// extend React namespace\nvar ReactMVx = Object.create(React);\n// Make it compatible with ES6 module format.\nReactMVx.default = ReactMVx;\n// listenToProps, listenToState, model, attributes, Model\nReactMVx.define = define;\nReactMVx.mixins = mixins;\nReactMVx.Node = type(Node).value(null);\nReactMVx.Element = type(Element).value(null);\nReactMVx.Link = Link;\nReactMVx.Component = Component;\nvar assignToState = ReactMVx.assignToState = function (key) {\n    return function (prop) {\n        var _a;\n        var source = prop && prop instanceof Link ? prop.value : prop;\n        this.state.assignFrom((_a = {}, _a[key] = source, _a));\n        if (source && source._changeToken) {\n            this.state[key]._changeToken = source._changeToken;\n        }\n    };\n};\nexport default ReactMVx;\nexport { define, mixins, Node, Element, Link, Component, assignToState };\n//# sourceMappingURL=index.js.map"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__rest","e","indexOf","getOwnPropertySymbols","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","StoreContext","createContext","Store","global","ExposeStore","Provider","StateMixin","_initializeState","state","props","__keepState","State","_owner","_ownerKey","_onChildrenChange","componentDidMount","asyncUpdate","componentWillUnmount","_preventDispose","dispose","contextType","compileSpecs","defaults","watchers","changeHandlers","propTypes","_loop_1","spec","ref","Type","isRequired","T","name_1","name","value","type","options","Number","PropTypes.number","String","PropTypes.string","Boolean","PropTypes.bool","PropTypes.array","Function","PropTypes.func","PropTypes.object","Node","PropTypes.node","Element","PropTypes.element","PropTypes.any","PropTypes.instanceOf","_translateType","_onChange","changeEvents","handlers","changeEvents_1","push","next","prev","component","stopListening","listenTo","_changeEventName","convert","_i","_a","Record","_attributesArray","createChangeTokensConstructor","propNames","keys","PropsChangeTokens","map","join","_hasChanges","EmptyPropsChangeTokensCtor","PureRenderMixin","shouldComponentUpdate","nextProps","_propsChangeTokens","updateChangeTokens","componentDidUpdate","ChangeHandlersMixin","handlePropsChanges","_changeHandlers","handler","WatchersMixin","componentWillReceiveProps","_watchers","name_2","componentWillMount","name_3","onDefine","definition","BaseClass","BaseComponentClass","ComponentState","_super","tslib_1.__extends","attributes","tslib_1.__decorate","define","mixins","merge","pureRender","_props","tools","_b","defaultProps","Messenger","Component","context","_this","linkAt","linkAll","linkPath","path","get","_links","enumerable","configurable","assignToState","x","assignFrom","setState","attrs","set","transaction","fun","isRoot","returnFalse","getStore","_defaultStore","_disposed","forceUpdate","definitions","mixinRules","protoValue","classLast","componentWillUpdate","classFirst","some","React.Component","ArrayProto","ObjectProto","helpers","getPrototypeOf","arrayHelpers","objectHelpers","dummyHelpers","clone","link","remove","iterator","mapped","element","at","object","cloned","array","slice","splice","j","y","Link","CustomLink","error","onChange","CloneLink","checked","requestChange","update","transform","pipe","action","equals","truthyValue","EqualsLink","enabled","defaultValue","EnabledLink","contains","ContainsLink","unshift","removeAt","_","LinkAt","pick","links","check","whenValid","defaultError","parent","arr","nextValue","concat","filter","el","typeR","populate","LinkedRecordMixin","cacheLink","getLinksCache","RecordDeepLink","MixinsState","RecordLink","record","attr","_error","getValidationError","other","deepGet","deepValidationError","_changeToken","deepSet","AttributesCopy","cached","Collection","linkContains","CollectionLink","prop","collection","toggle","PureComponent","ReactMVx","React","default","source","StoreClass","ComponentClass","LocalStoreComponent","store","render","children","tslib_1.__rest","React.createElement","tslib_1.__assign","ExternalStoreComponent"],"mappings":"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"}